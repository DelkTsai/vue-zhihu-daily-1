{"version":3,"file":"static/js/2.c4aa8bd8c2f5209751c2.js","sources":["webpack:///src/views/NewsDetail/index.vue"],"sourcesContent":["<template>\n  <div class=\"news-detail\">\n    <link rel=\"stylesheet\" :href=\"story.css\">\n    <detail-header class=\"detail-header\" v-if=\"story.id\" :story-extra=\"storyExtra\" @show-share=\"toggleShareModal\" @collect=\"notComplete\" @to-comment=\"toComment\" @thumb-up=\"notComplete\"></detail-header>\n    <div class=\"container\">\n      <div class=\"top\" v-if=\"story.image\">\n        <img class=\"img\" :src=\"image403(story.image)\" alt=\"\">\n        <div class=\"mask\"></div>\n        <span class=\"title\">{{story.title}}</span>\n        <span class=\"image-source\">{{story.image_source}}</span>\n      </div>\n      <div class=\"my-body\" v-html=\"image403(story.body)\"></div>\n    </div>\n\n    <!-- 点击头部分享按钮显示的分享方式 -->\n    <transition name=\"fade\">\n      <div class=\"share-mask\" v-show=\"shareModalIsShow\" @click=\"toggleShareModal\">\n        <share-modal class=\"share-modal\" v-show=\"shareModalIsShow\"></share-modal>\n      </div>\n    </transition>\n\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport image403 from '../../utils/image403'\nexport default {\n  data () {\n    return {\n      story: {},\n      storyExtra: {},\n      shareModalIsShow: false, // 控制分享modal是否显示\n      isFirstEnter: false // 是否是第一次进入\n    }\n  },\n  components: {\n    DetailHeader: () => import('@/components/DetailHeader'),\n    ShareModal: () => import('@/components/ShareModal')\n  },\n  // 此处是在该组件挂载之后执行的内容，但是在<router-view>外使用了<keep-alive>时，从该页返回到HomePage之后，这一页依然是缓存的，不会被清除，所以在HomePage点击另一条新闻进入这一页时，这一页依然会保持和第一次进入的内容一样。\n  created () {\n    this.isFirstEnter = true\n  },\n  beforeRouteEnter (to, from, next) {\n    if (from.name === 'homePage') {\n      // 如果是从首页跳转过来的，说明不是返回操作\n      to.meta.isBack = false\n    } else if (from.name === 'comment') {\n      // 如果是从评论页跳转过来的，是返回操作\n      to.meta.isBack = true\n    }\n    next()\n  },\n  activated () {\n    if (!this.$route.meta.isBack || this.isFirstEnter) {\n      this.getNews().then(() => {\n        this.getStoryExtra()\n      })\n    }\n  },\n  methods: {\n    image403,\n    // 获取新闻详情\n    getNews () {\n      return axios.get(`/api/4/news/${this.$route.params.id}`).then(res => {\n        if (res.status === 200) {\n          this.story = res.data\n        }\n      })\n    },\n    // 获取新闻额外消息，获取到的内容需要传递给DetailHeader这个组件\n    getStoryExtra () {\n      return axios.get(`/api/4/story-extra/${this.story.id}`).then((res) => {\n        if (res.status === 200) {\n          this.storyExtra = res.data\n        }\n      })\n    },\n    // 显示或隐藏分享框\n    toggleShareModal () {\n      this.shareModalIsShow = !this.shareModalIsShow\n    },\n    // 点击收藏，略略略\n    notComplete () {\n      this.$toast({\n        message: '假的！点了没用那种，气不气(～￣▽￣)～',\n        duration: 200\n      })\n    },\n    toComment () {\n      this.$router.push({\n        name: 'comment',\n        params: {\n          id: this.story.id\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.news-detail {\n  // height: 100%;\n  // overflow: auto;\n  .detail-header {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    z-index: 5;\n  }\n  .container {\n    padding-top: 112px;\n    position: relative;\n    .top {\n      width: 100%;\n      height: 420px;\n      position: absolute;\n      overflow: hidden;\n      color: #fff;\n      .img {\n        width: 100%;\n        height: auto;\n        position: absolute;\n        top: 50%;\n        left: 0;\n        transform: translateY(-50%);\n      }\n      .mask {\n        width: 100%;\n        height: 420px;\n        position: absolute;\n        background: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.5));\n      }\n      .title {\n        position: absolute;\n        left: 0;\n        bottom: 50px;\n        padding: 0 20px;\n        line-height: 60px;\n      }\n      .image-source {\n        position: absolute;\n        right: 40px;\n        bottom: 15px;\n        font-size: 24px;\n        opacity: 0.7;\n      }\n    }\n  }\n  .share-mask {\n    position: fixed;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.5);\n    z-index: 5;\n    .share-modal {\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      transform: translate(-50%, -50%);\n    }\n  }\n  .fade-enter, .fade-leave-to {\n    opacity: 0;\n  }\n  .fade-enter-active, .fade-leave-active {\n    transition: opacity 0.2s linear;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/NewsDetail/index.vue"],"mappings":"AA2BA","sourceRoot":""}